# ============================================================================
# CodeRunner Microservice - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env file with sensitive data to version control
# ============================================================================

# ----------------------------------------------------------------------------
# APPLICATION CONFIGURATION
# ----------------------------------------------------------------------------
APP_NAME=microservice-code-runner
API_VERSION=v1

# Server Ports
PORT=8084
GRPC_PORT=9084

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION (PostgreSQL)
# ----------------------------------------------------------------------------
# For local development
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=code_runner_db
DB_SSLMODE=disable
DB_TIMEZONE=UTC

# For Azure Database for PostgreSQL
# DB_HOST=your-server.postgres.database.azure.com
# DB_PORT=5432
# DB_USER=your_admin@your-server
# DB_PASSWORD=your_secure_password
# DB_NAME=code_runner_db
# DB_SSLMODE=require
# DB_TIMEZONE=UTC

# Database Connection Pool Settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=10
DB_CONN_MAX_LIFETIME=3600

# ----------------------------------------------------------------------------
# KAFKA / AZURE EVENT HUB CONFIGURATION
# ----------------------------------------------------------------------------
# Azure Event Hub Configuration (Kafka-compatible)
# Get these values from Azure Portal > Event Hubs Namespace > Shared access policies

# Event Hub Namespace endpoint (format: <namespace>.servicebus.windows.net:9093)
KAFKA_BOOTSTRAP_SERVERS=your-namespace.servicebus.windows.net:9093

# Full connection string from Azure Portal
# Format: Endpoint=sb://<namespace>.servicebus.windows.net/;SharedAccessKeyName=<KeyName>;SharedAccessKey=<KeyValue>;EntityPath=<EventHubName>
KAFKA_CONNECTION_STRING=Endpoint=sb://your-namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=your-shared-access-key;EntityPath=your-eventhub-name

# Event Hub name (topic)
KAFKA_TOPIC=challenge.completed

# Consumer group ID
KAFKA_CONSUMER_GROUP=code-runner-service

# SASL Configuration for Azure Event Hub
KAFKA_SASL_MECHANISM=PLAIN
KAFKA_SECURITY_PROTOCOL=SASL_SSL

# Timeout settings (in milliseconds)
KAFKA_PRODUCER_TIMEOUT_MS=30000
KAFKA_CONSUMER_TIMEOUT_MS=30000

# Retry settings
KAFKA_MAX_RETRIES=3

# ----------------------------------------------------------------------------
# KAFKA LOCAL DEVELOPMENT (Alternative to Azure Event Hub)
# ----------------------------------------------------------------------------
# Uncomment these for local Kafka development without Azure
# KAFKA_BOOTSTRAP_SERVERS=localhost:9092
# KAFKA_CONNECTION_STRING=
# KAFKA_TOPIC=challenge.completed
# KAFKA_CONSUMER_GROUP=code-runner-service
# KAFKA_SASL_MECHANISM=
# KAFKA_SECURITY_PROTOCOL=PLAINTEXT
# KAFKA_PRODUCER_TIMEOUT_MS=30000
# KAFKA_CONSUMER_TIMEOUT_MS=30000
# KAFKA_MAX_RETRIES=3

# ----------------------------------------------------------------------------
# SERVICE DISCOVERY (Eureka)
# ----------------------------------------------------------------------------
# Enable/Disable service discovery
SERVICE_DISCOVERY_ENABLED=false

# Eureka server URL (if using service discovery)
# SERVICE_DISCOVERY_URL=http://eureka-server:8761/eureka

# Service name to register in Eureka
SERVICE_NAME=CODE-RUNNER-SERVICE

# Public IP for service registration (optional, will auto-detect if not set)
# SERVICE_PUBLIC_IP=

# For Azure Container Instances or Azure Kubernetes Service
# SERVICE_PUBLIC_IP=your-container-public-ip
# SERVICE_DISCOVERY_URL=http://your-eureka-server:8761/eureka
# SERVICE_DISCOVERY_ENABLED=true

# ----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# ----------------------------------------------------------------------------
# Log level: debug, info, warn, error
LOG_LEVEL=info

# Log format: json, text
LOG_FORMAT=json

# ----------------------------------------------------------------------------
# PGADMIN CONFIGURATION (for local development)
# ----------------------------------------------------------------------------
PGADMIN_EMAIL=admin@coderunner.local
PGADMIN_PASSWORD=admin123
PGADMIN_PORT=5050

# ============================================================================
# AZURE CONFIGURATION QUICK REFERENCE
# ============================================================================
#
# To configure Azure Event Hub:
# 1. Create an Event Hubs Namespace in Azure Portal
# 2. Create an Event Hub (topic) within the namespace
# 3. Go to Shared access policies and copy the connection string
# 4. Set KAFKA_BOOTSTRAP_SERVERS to: <namespace>.servicebus.windows.net:9093
# 5. Set KAFKA_CONNECTION_STRING to the full connection string
# 6. Set KAFKA_TOPIC to your Event Hub name
#
# To configure Azure Database for PostgreSQL:
# 1. Create an Azure Database for PostgreSQL server
# 2. Set DB_HOST to: <server-name>.postgres.database.azure.com
# 3. Set DB_USER to: <admin-username>@<server-name>
# 4. Set DB_PASSWORD to your database password
# 5. Set DB_SSLMODE to: require
# 6. Configure firewall rules to allow connections
#
# Security Best Practices:
# - Never commit .env file to version control
# - Use Azure Key Vault for production secrets
# - Rotate credentials regularly
# - Use managed identities when possible
# - Enable SSL/TLS for all connections
#
# ============================================================================
